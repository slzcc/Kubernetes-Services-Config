apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: confluence-data-backup
spec:
  schedule: "* */23 * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: confluence-data-backup
            image: busybox
            args:
            - /bin/sh
            - -c
            - tar zcf confluence_`date +%F_%R`.tar.gz -C /mysqlBackup data
            volumeMounts:
              - mountPath: "/mysqlBackup"
                name: data
            env:
            - name: TZ
              value: "Asia/Shanghai"
          volumes:
            - hostPath:
                path: "/var/data/opt/altassian/confluence"
              name: data
          restartPolicy: OnFailure
